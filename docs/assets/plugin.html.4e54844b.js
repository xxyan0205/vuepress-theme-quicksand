import{r as n,o as s,c as a,a as e,w as l,F as t,b as o,d as p}from"./app.ae737f76.js";const c={},r=e("h1",{id:"开发插件",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#开发插件","aria-hidden":"true"},"#"),o(" 开发插件")],-1),i={class:"custom-container tip"},u=e("p",{class:"custom-container-title"},"提示",-1),d=o("在阅读该指南之前，你最好先了解一下 VuePress 的 "),b=o("架构"),m=o(" 。"),k=e("h2",{id:"创建一个插件",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#创建一个插件","aria-hidden":"true"},"#"),o(" 创建一个插件")],-1),g=o("VuePress 插件是一个符合 "),h=o("插件 API"),v=o(" 的普通 JavaScript 对象，称之为 "),f=e("em",null,"插件对象",-1),j=o(" 。"),x=e("p",null,[o("如果插件想要接收用户配置项，那么它可以是一个返回值为 "),e("em",null,"插件对象"),o(" 的函数，称之为 "),e("em",null,"插件函数"),o(" 。")],-1),q=e("div",{class:"theme-code-light"},[e("div",{class:"language-javascript ext-js line-numbers-mode"},[e("pre",{class:"language-javascript"},[e("code",null,[e("span",{class:"token keyword"},"const"),o(" fooPlugin "),e("span",{class:"token operator"},"="),o(),e("span",{class:"token punctuation"},"{"),o("\n  name"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token string"},"'vuepress-plugin-foo'"),e("span",{class:"token punctuation"},","),o("\n  "),e("span",{class:"token comment"},"// ..."),o("\n"),e("span",{class:"token punctuation"},"}"),o("\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br")])])],-1),y=e("div",{class:"theme-code-light"},[e("div",{class:"language-javascript ext-js line-numbers-mode"},[e("pre",{class:"language-javascript"},[e("code",null,[e("span",{class:"token keyword"},"const"),o(),e("span",{class:"token function-variable function"},"fooPlugin"),o(),e("span",{class:"token operator"},"="),o(),e("span",{class:"token punctuation"},"("),e("span",{class:"token parameter"},[o("options"),e("span",{class:"token punctuation"},","),o(" app")]),e("span",{class:"token punctuation"},")"),o(),e("span",{class:"token operator"},"=>"),o(),e("span",{class:"token punctuation"},"{"),o("\n  "),e("span",{class:"token keyword"},"return"),o(),e("span",{class:"token punctuation"},"{"),o("\n    name"),e("span",{class:"token operator"},":"),o(),e("span",{class:"token string"},"'vuepress-plugin-foo'"),e("span",{class:"token punctuation"},","),o("\n    "),e("span",{class:"token comment"},"// ..."),o("\n  "),e("span",{class:"token punctuation"},"}"),o("\n"),e("span",{class:"token punctuation"},"}"),o("\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br"),e("span",{class:"line-number"},"2"),e("br"),e("span",{class:"line-number"},"3"),e("br"),e("span",{class:"line-number"},"4"),e("br"),e("span",{class:"line-number"},"5"),e("br"),e("span",{class:"line-number"},"6"),e("br")])])],-1),P=p('<h2 id="发布到-npm" tabindex="-1"><a class="header-anchor" href="#发布到-npm" aria-hidden="true">#</a> 发布到 NPM</h2><p>一个典型的插件 Package 的结构如下所示：</p><div class="theme-code-light"><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>vuepress-plugin-foo\n├─ lib\n│  └─ index.js\n└─ package.json\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div><h3 id="插件入口" tabindex="-1"><a class="header-anchor" href="#插件入口" aria-hidden="true">#</a> 插件入口</h3><p><code>lib/index.js</code> 文件是插件入口，它应当直接导出插件：</p>',5),w=e("div",{class:"theme-code-light"},[e("div",{class:"language-javascript ext-js line-numbers-mode"},[e("pre",{class:"language-javascript"},[e("code",null,[o("module"),e("span",{class:"token punctuation"},"."),o("exports "),e("span",{class:"token operator"},"="),o(" fooPlugin\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br")])])],-1),_=e("div",{class:"theme-code-light"},[e("div",{class:"language-javascript ext-js line-numbers-mode"},[e("pre",{class:"language-javascript"},[e("code",null,[e("span",{class:"token keyword"},"export"),o(),e("span",{class:"token keyword"},"default"),o(" fooPlugin\n")])]),e("div",{class:"line-numbers"},[e("span",{class:"line-number"},"1"),e("br")])])],-1),S={class:"custom-container tip"},C=e("p",{class:"custom-container-title"},"提示",-1),M=e("p",null,"注意，插件入口会在 Node 中被加载，因此它应为 CommonJS 格式。",-1),J=o("如果你使用 ESM 格式，你需要使用 "),N={href:"https://babeljs.io/",target:"_blank",rel:"noopener noreferrer"},z=o("babel"),E=o(" 或 "),G={href:"https://www.typescriptlang.org/",target:"_blank",rel:"noopener noreferrer"},I=o("typescript"),L=o(" 来将它编译成 CommonJS 。"),V=e("h3",{id:"package-json",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#package-json","aria-hidden":"true"},"#"),o(" package.json")],-1),A=o("为了把 Package 发布到 NPM 上，"),F={href:"https://docs.npmjs.com/cli/v6/configuring-npm/package-json",target:"_blank",rel:"noopener noreferrer"},O=o("package.json"),R=o(" 文件是必需的："),B=p('<div class="theme-code-light"><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vuepress-plugin-foo&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token string">&quot;vuepress-plugin&quot;</span><span class="token punctuation">,</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lib/index.js&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token string">&quot;lib&quot;</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></div><ul><li>将 <code>name</code> 按照约定命名： <code>vuepress-plugin-xxx</code> 或 <code>@org/vuepress-plugin-xxx</code> 。</li><li>在 <code>keywords</code> 中包含 <code>vuepress-plugin</code> ，这样用户可以在 NPM 上搜索到你的插件。</li><li>将 <code>main</code> 设为插件入口文件。</li><li>设置 <code>files</code> ，仅发布 <code>lib</code> 目录下的文件。</li></ul>',2);c.render=function(o,p){const c=n("RouterLink"),D=n("CodeGroupItem"),H=n("CodeGroup"),K=n("OutboundLink");return s(),a(t,null,[r,e("div",i,[u,e("p",null,[d,e(c,{to:"/zh/advanced/architecture.html"},{default:l((()=>[b])),_:1}),m])]),k,e("p",null,[g,e(c,{to:"/zh/reference/plugin-api.html"},{default:l((()=>[h])),_:1}),v,f,j]),x,e(H,null,{default:l((()=>[e(D,{title:"插件对象",active:""},{default:l((()=>[q])),_:1}),e(D,{title:"插件函数"},{default:l((()=>[y])),_:1})])),_:1}),P,e(H,null,{default:l((()=>[e(D,{title:"CJS",active:""},{default:l((()=>[w])),_:1}),e(D,{title:"ESM"},{default:l((()=>[_])),_:1})])),_:1}),e("div",S,[C,M,e("p",null,[J,e("a",N,[z,e(K)]),E,e("a",G,[I,e(K)]),L])]),V,e("p",null,[A,e("a",F,[O,e(K)]),R]),B],64)};export default c;
